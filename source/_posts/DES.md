---
title: DES
date: 2018-12-20 00:01:07
tags: encryption
---
# DES原理
## 简介
DES加密算法，一种对称加密算法，加密速度比较快。
DES算法有三个参数：Key（密钥）,Data（数据），Mode（加密/解密）。
DES将64位明文加密位64位密文，当文本更长时划分位64位块进行每块一加密。
DES加密和解密的流程是一样的，唯一不一样的地方在于密钥的顺序相反，如10100变成00101
## 流程图
![](https://ws1.sinaimg.cn/large/0063dFB6gy1fycg5qjp45j30f90eegmy.jpg)
## 加密过程
### 获取子密钥Ki
DES初始密钥为64位，按8行8列从左往右上下排列，其中每行第八位用于奇偶校验(完整性)，不参与加密，实际参与加密运算的为56位。
54位的实际Key经过密钥置换表PC-1置换之后，生成新的56位的串。
这个密钥置换表貌似是固定的，因为解密加密是相同的操作，如果不固定怎么解密。
![](https://ws1.sinaimg.cn/large/0063dFB6gy1fycgfatopaj30bh09tdhn.jpg)
经过PC-1置换后，将56位分为前28位C0和后28位D0两部分。
然后分别循环左移1位得到C1和D1，然后合并成56位。
然后经过PC-2压缩置换后生成48位的子密钥K1。
![](https://ws1.sinaimg.cn/large/0063dFB6gy1fycgidojjjj309f09sta5.jpg)
C1、D1分别循环左移1位得到C2、D2，合并后经过PC-2压缩置换生成子密钥K2.
同理，直至生成K16.每轮循环左移的位数也是固定的：
![](https://ws1.sinaimg.cn/large/0063dFB6gy1fycgkece9uj30et031q3e.jpg)
### 密码函数F
#### IP置换
64位数据经过IP表进行置换，生成后的新64位数据分为坐32位L0和右32位R0.
![](https://ws1.sinaimg.cn/large/0063dFB6gy1fycgmv4amij308908aq42.jpg)
#### E扩展置换
将IP置换后的右半部分R0，扩展为48位输出。
扩展置换表：
![](https://ws1.sinaimg.cn/large/0063dFB6gy1fycgvreaznj30by09mq2y.jpg)
将32位分为4位8列，两边取相邻的位进行扩展。
#### 异或运算
将扩展输出的48位和子密钥异或得到48位数据。
#### S盒置换
将异或后的数据送入S盒，S盒置换由8个不同的S盒完成，每个S盒有6位输入4位输出。48位输入分为8个6位分组，输入到8个S盒中，在相应的S盒中置换。
![](https://ws1.sinaimg.cn/large/0063dFB6gy1fych1ck1mwj30hf08a74z.jpg)
一个S盒就i是一个4行16列的表，盒中每一项都是一个4位的数(0000-1111即0-15)，S盒的6个输入确定了选择哪个项进行输出。
输入的6位中，最高最低两位选择行数，中间四位选择列数，选择到的那个数字，就是S盒的输出值。
（想不到吧，其他的都是用原文密钥通过某种函数来变换位置，这一步是通过数值确定坐标选择固定的表[S盒]中的值）
![8个S盒的表格](https://ws1.sinaimg.cn/large/0063dFB6gy1fych8a323bj30gx0qpt91.jpg)
例如S盒8的的输入是110011，第1位和第6位组合11，对应第三行，第二到第五位是1001，对应第9列，S盒8行9列的项是12，因此用12的二进制1100来代替输入110011输出。
S盒置换过程输出8个4位的分组，组合在一起形成32位数据。
S盒置换是DES算法的关键步骤，其他的运算都是线性的，容易分析，而S盒是非线性的，更安全。
#### P盒置换
S盒的32位结果通过P盒再置换一次，生成新的32位输出结果。
![](https://ws1.sinaimg.cn/large/0063dFB6gy1fychev90c6j306e0b0gmf.jpg)
### 迭代运算
第一轮：R0与子密钥K1经过密码函数F(R0,K1)得到32位输出f1,f1与L0二进制异或赋值给R1，R0原封不动赋值给L1。
第二轮：R1与子密钥K2经过密码函数F(R1,K2)得到32位输出f2，f2与L1二进制异或复制给R2，R1原封不动复制给L2.
一共进行16轮，最后生成L16，R16.
### 末置换
L16与R16合并在一起64位，经过末置换表IP-1置换，得到64位密文输出。
![](https://ws1.sinaimg.cn/large/0063dFB6gy1fychp0fbftj308t08l75o.jpg)